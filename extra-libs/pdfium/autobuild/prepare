abinfo "Symlinking Chromium build modules ..."
ln -sv "$SRCDIR"/../build \
    "$SRCDIR"/build

for i in abseil-cpp icu zlib; do
    abinfo "Symlinking $i sources ..."
    ln -sv "$SRCDIR"/../$i \
        "$SRCDIR"/third_party/$i
done

abinfo "AUR: Debundling ICU ..."
mkdir -pv "$SRCDIR"/third_party/icu
ln -sfv "$SRCDIR"/build/linux/unbundle/icu.gn \
    "$SRCDIR"/third_party/icu/BUILD.gn

mkdir -pv "$SRCDIR"/tools/generate_shim_headers/
curl https://chromium.googlesource.com/chromium/src/+/master/tools/generate_shim_headers/generate_shim_headers.py?format=TEXT \
    | base64 --decode > "$SRCDIR"/tools/generate_shim_headers/generate_shim_headers.py

abinfo "Creating gclient_args.gni ..."
touch "$SRCDIR"/build/config/gclient_args.gni

abinfo "AUR: Excluding test fonts from build ..."
sed -e '/"\/\/third_party\/test_fonts",/s/^/#/g' \
    -i "$SRCDIR"/testing/BUILD.gn
